<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Results Dashboard</title>
    <!-- Link to Font Awesome (Optional) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Link to your new CSS file -->
    <link rel="stylesheet" href="../../CSS/viewresult.css">
    <!-- Link to the original CSS for detailed view/printing (if needed, adjust path) -->
    <link rel="stylesheet" href="../../CSS/viewresultprint.css" media="print">
    <link rel="stylesheet" href="../../CSS/viewdetailedresult.css" media="screen"> <!-- Separate CSS for detailed view screen style -->

</head>
<body class="result-page">

    <!-- Header -->
    <header class="main-header">
        <div class="header-left">
            <!-- <button class="menu-btn"><i class="fas fa-bars"></i></button> -->
            <span class="logo">StudyCore</span>
        </div>
        <div class="header-center">
            <h1 id="exam-title">JEE Main 2025 (Online) 22nd January Evening Slot</h1>
            <p id="exam-date-time">Monday, 31 March 2025 at 06:08 pm</p>
        </div>
        <div class="header-right">
             <span class="overall-score-display">
                <strong id="header-score">---</strong>/<span id="header-max-score">300</span>
            </span>
            <!-- Add other icons if needed -->
            <!-- <button title="Download"><i class="fas fa-download"></i></button>
            <button title="Settings"><i class="fas fa-cog"></i></button>
            <button title="User"><i class="fas fa-user"></i></button> -->
        </div>
    </header>

    <!-- Main Content Area -->
    <div class="main-container">
        <!-- Sidebar for Past Attempts -->
        <aside class="attempts-list-section">
            <h2>Past Attempts</h2>
             <p><small>(Select an attempt to view results)</small></p>
            <ul id="attempts-list">
                <li>Loading attempts...</li>
            </ul>
             <a href="#" class="back-link">View All Test Results</a>
             <a href="../../index.html" class="back-link">Back to Test List</a>
        </aside>

        <!-- Main Dashboard / Detailed View Area -->
        <main class="results-display-area">

            <!-- Initial Message / No Selection Message -->
            <section id="select-attempt-message" class="message-center">
                <p>Please select an attempt from the list on the left to view the results dashboard.</p>
            </section>

            <!-- Dashboard View (Initially Hidden) -->
            <div id="dashboard-view" class="dashboard-container" style="display: none;">

                <!-- Top Summary Row -->
                <section class="results-overview grid-container">
                    <div class="card chart-card">
                        <h3>Score Breakdown</h3>
                        <div class="chart-container">
                             <canvas id="scorePieChart"></canvas>
                        </div>
                        <div id="chart-legend" class="chart-legend">
                            <!-- Legend generated by JS -->
                        </div>
                    </div>
                    <div class="card metric-card">
                        <h3>Time</h3>
                        <p class="metric-value" id="metric-time">--:--:--</p>
                        <p class="metric-label">Total Time Taken</p>
                    </div>
                    <div class="card metric-card">
                        <h3>Accuracy</h3>
                        <p class="metric-value" id="metric-accuracy">--.--%</p>
                        <p class="metric-label">Of Attempted</p>
                    </div>
                    <div class="card metric-card">
                        <h3>Attempted</h3>
                        <p class="metric-value" id="metric-attempted">-- / --</p>
                        <p class="metric-label">Questions</p>
                    </div>
                    <div class="card metric-card">
                        <h3>Negative Marks</h3>
                        <p class="metric-value" id="metric-negative">--.--</p>
                         <p class="metric-label">Marks Deducted</p>
                    </div>
                </section>

                <!-- Action Buttons Row -->
                <section class="action-buttons">
                    <button id="print-dashboard-btn" class="btn btn-secondary action-button"><i class="fas fa-print"></i> Print Dashboard</button>
                    <button id="view-all-questions-btn" class="action-btn primary"><i class="fas fa-list-ul"></i> View In Detail</button>
                    <!-- <button id="view-marked-review-btn" class="action-btn secondary"><i class="fas fa-flag"></i> Marked for Review</button> -->
                </section>

                 <!-- Time Management Summary -->
                <section class="time-management-summary card">
                    <h3>Time Management</h3>
                    <div class="time-split">
                        <div class="time-item correct-time">
                            <i class="fas fa-check-circle"></i>
                            <span class="time-label">Correct</span>
                            <span class="time-value" id="time-correct">--h --m --s</span>
                        </div>
                        <div class="time-item wrong-time">
                             <i class="fas fa-times-circle"></i>
                            <span class="time-label">Wrong</span>
                            <span class="time-value" id="time-wrong">--m --s</span>
                        </div>
                        <div class="time-item not-attempted-time">
                            <i class="fas fa-minus-circle"></i>
                            <span class="time-label">Not Attempted</span>
                            <span class="time-value" id="time-not-attempted">--h --m --s</span>
                        </div>
                    </div>
                </section>

                <!-- Sections Overview Table -->
                <section class="sections-overview card">
                    <h3>Sections Overview</h3>
                    <div class="table-container">
                        <table id="sections-table">
                            <thead>
                                <tr>
                                    <th>Section</th>
                                    <th>Score</th>
                                    <th>Accuracy</th>
                                    <th>Attempted</th>
                                    <th>Time</th>
                                </tr>
                            </thead>
                            <tbody id="sections-table-body">
                                <!-- Rows generated by JS -->
                                <tr><td colspan="5">Loading section data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                <!-- Detailed Section Analysis Cards -->
                <section class="detailed-section-analysis">
                    <h3 class="section-title">Detailed Section Analysis</h3>
                    <div id="detailed-section-cards-container" class="grid-container">
                        <!-- Section cards will be generated by JS here -->
                        <p>Loading detailed section analysis...</p>
                    </div>
                </section>

            </div> <!-- End Dashboard View -->

            <!-- Detailed Question Review Area (Initially Hidden) -->
            <!-- This section now handles Section Tabs View, Chapter Summary View, and Chapter Questions View -->
            <section id="detailed-results-area" style="display: none;">
                <div class="action-buttons"> <!-- Action buttons for this entire view -->
                    <button id="back-to-dashboard-btn" class="action-btn secondary"><i class="fas fa-arrow-left"></i> Back to Dashboard</button>
                    <!-- Print button prints questions (either section or chapter filtered) -->
                    <button id="print-results-button" class="btn btn-secondary action-button" title="Print Questions Shown Below"><i class="fas fa-print"></i> Print Questions</button>
                    <!-- ** NEW: Button to switch to chapter summary view ** -->
                    <button id="see-chapterwise-btn" class="btn btn-outline-secondary ms-2 action-button" title="View Chapter-wise Summary"><i class="fas fa-book-open"></i> See Chapterwise</button>
                    <button id="view-by-section-btn" class="btn btn-toggle active" title="View Questions by Section"><i class="fas fa-layer-group"></i> View By Section</button>
                </div>

                <h2>Detailed Review <span id="attempt-timestamp"></span></h2>

                <!-- ** NEW: Container for Chapter Summary Cards (Initially Hidden) ** -->
                <!-- Add CSS for layout (e.g., grid or flex) -->
                <div id="chapter-summary-view" class="grid-container chapter-cards-container" style="display: none;">
                    <!-- Chapter cards generated by JS -->
                    <p>Loading chapter summary...</p>
                </div>

                <!-- Existing container for Section Tabs (Hidden when Chapter View active) -->
                <div class="review-section-tabs" id="review-section-tabs">
                    <!-- Review section tabs generated by JS -->
                </div>

                 <!-- ** NEW: Title shown when viewing questions filtered by Chapter ** -->
                 <h4 id="chapter-questions-title" style="display: none; margin-top: 15px; margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px solid #ccc;"></h4>

                <!-- Existing container for displaying question lists (Sections or Chapters) -->
                <div class="review-questions-container" id="review-questions-container">
                    <!-- Questions generated by JS -->
                </div>

            </section> <!-- End Detailed Results Area -->


            <!-- Chapter-wise Analysis Modal (Used for SECTION-SPECIFIC breakdown from Dashboard card) -->
             <div id="chapter-analysis-modal" class="modal-overlay" style="display: none;">
                 <div class="modal-content">
                     <button class="modal-close-btn" id="close-chapter-modal-btn" title="Close">×</button>
                     <h3 id="chapter-analysis-title">Chapter-wise Analysis</h3>
                     <div id="chapter-analysis-table-container">
                         <!-- Table will be generated here by JS for section-specific modal -->
                         <p>Loading analysis...</p>
                     </div>
                 </div>
             </div>

        </main> <!-- End results-display-area -->
    </div> <!-- End Main Container -->

    <!-- 1. Include Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- 2. Define Target Test Name BEFORE including the script -->
    <script>
        // **** IMPORTANT: SET THIS TO THE CORRECT TEST NAME ****
        const TARGET_TEST_NAME = "JEE Main 8 April S2"; // Example: Change this to match the test
        // **** IMPORTANT: SET MAX SCORE AND MARKING SCHEME ****
        const MAX_SCORE = 300; // Example: Max possible score for the test
        const MARKS_CORRECT = 4;  // Example: Marks for a correct answer
        const MARKS_INCORRECT = -1; // Example: Marks for an incorrect answer (negative penalty)
    </script>

    <!-- 3. Include the Modified Universal Result JS file -->
    <!-- Make sure the path is correct relative to THIS HTML file -->
    <script src="../../JS/Viewresult.js"></script>

</body>
</html>